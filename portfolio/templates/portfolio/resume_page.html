<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>{{ about.name }} - Resume</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        /* --- RESET & BASE --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 10.5pt; /* Slightly smaller base font for efficiency */
            line-height: 1.4;
            color: #222;
            background: #555;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- BUTTON --- */
        #download-button {
            padding: 10px 25px;
            margin-bottom: 20px;
            background-color: #1db954;
            color: white;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        #download-button:hover { background-color: #1ed760; }

        /* --- PAPER SHEET --- */
        #resume-content {
            background: white;
            width: 210mm; /* A4 Width */
            min-height: 296mm; /* A4 Height */
            padding: 0.5in; /* Standard printable margin */
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
            box-sizing: border-box;
        }

        /* --- HEADER --- */
        header {
            text-align: center;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        h1 {
            margin: 0;
            text-transform: uppercase;
            font-size: 24pt;
            letter-spacing: 1px;
        }
        .role {
            font-size: 12pt;
            color: #555;
            margin: 5px 0;
            font-weight: 500;
        }
        .contact-line {
            font-size: 9pt;
            margin-top: 5px;
        }
        .contact-line span {
            margin: 0 8px;
            color: #ccc;
        }
        .contact-line a {
            color: #333;
            text-decoration: none;
        }

        /* --- SECTIONS --- */
        section {
            margin-bottom: 12px; /* Tight spacing between sections */
        }
        h2 {
            font-size: 12pt;
            text-transform: uppercase;
            border-bottom: 1px solid #ccc;
            margin: 0 0 8px 0;
            padding-bottom: 2px;
            color: #333;
        }

        /* --- ENTRIES (Jobs/Projects) --- */
        .entry {
            margin-bottom: 10px;
            page-break-inside: avoid; /* Don't cut items in half */
        }
        .entry-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }
        .entry-title {
            font-size: 11pt;
            font-weight: bold;
            color: #000;
        }
        .entry-date {
            font-size: 9pt;
            font-style: italic;
            color: #666;
            white-space: nowrap;
        }
        .entry-subtitle {
            font-size: 10pt;
            font-weight: 600;
            color: #444;
            margin-bottom: 2px;
        }
        .entry-desc {
            font-size: 10pt;
            text-align: justify;
            color: #333;
        }

        /* --- SKILLS (Horizontal List) --- */
        .skills-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .skill-item {
            font-size: 9.5pt;
            background-color: #f0f0f0;
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }

        /* --- PDF PRINT RULES --- */
        @media print {
            body { background: none; padding: 0; margin: 0; }
            #download-button { display: none; }
            #resume-content { box-shadow: none; margin: 0; width: 100%; height: 100%; }
        }
    </style>
</head>
<body>

    <button id="download-button" onclick="generatePDF()">
        Download PDF
    </button>

    <div id="resume-content">
        
        <header>
            <h1>{{ about.name }}</h1>
            <div class="role">{{ about.title }}</div>
            <div class="contact-line">
                {% if socials.email %}
                    <a href="{{ socials.email }}">{{ socials.email_link }}</a>
                {% endif %}
                {% if socials.linkedin %}
                    <span>|</span> <a href="{{ socials.linkedin }}">LinkedIn</a>
                {% endif %}
                {% if socials.github %}
                    <span>|</span> <a href="{{ socials.github }}">GitHub</a>
                {% endif %}
            </div>
        </header>

        {% if about.description %}
        <section>
            <h2>Professional Summary</h2>
            <div class="entry-desc">{{ about.description }}</div>
        </section>
        {% endif %}

        {% if skills %}
        <section>
            <h2>Technical Skills</h2>
            <div class="skills-container">
                {% for skill in skills %}
                    <span class="skill-item">{{ skill.name }}</span>
                {% endfor %}
            </div>
        </section>
        {% endif %}

        {% if projects %}
        <section>
            <h2>Projects</h2>
            {% for project in projects %}
            <div class="entry">
                <div class="entry-header">
                    <div class="entry-title">{{ project.title }}</div>
                    <div class="entry-date">Project</div>
                </div>
                <div class="entry-desc">{{ project.short_description }}</div>
            </div>
            {% endfor %}
        </section>
        {% endif %}

        {% if jobs %}
        <section>
            <h2>Experience</h2>
            {% for job in jobs %}
            <div class="entry">
                <div class="entry-header">
                    <div class="entry-title">{{ job.role }}</div>
                    <div class="entry-date">{{ job.start_date }} – {{ job.end_date|default:"Present" }}</div>
                </div>
                <div class="entry-subtitle">{{ job.company }} {% if job.location %}| {{ job.location }}{% endif %}</div>
                <div class="entry-desc">
                    {{ job.description|linebreaksbr }}
                </div>
            </div>
            {% endfor %}
        </section>
        {% endif %}

        {% if educations %}
        <section>
            <h2>Education</h2>
            {% for edu in educations %}
            <div class="entry">
                <div class="entry-header">
                    <div class="entry-title">{{ edu.institution }}</div>
                    <div class="entry-date">{{ edu.start_year }} – {{ edu.end_year }}</div>
                </div>
                <div class="entry-subtitle">{{ edu.degree }}</div>
                {% if edu.description %}
                <div class="entry-desc">{{ edu.description }}</div>
                {% endif %}
            </div>
            {% endfor %}
        </section>
        {% endif %}

    </div>

    <script>
        function generatePDF() {
            const element = document.getElementById('resume-content');
            const button = document.getElementById('download-button');
            
            button.innerText = "Generating PDF...";
            button.disabled = true;

            const opt = {
                margin:       0, // CSS handles the padding inside #resume-content
                filename:     '{{ about.name|slugify }}_Resume.pdf',
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true },
                jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                button.innerText = "Download PDF";
                button.disabled = false;
            });
        }
    </script>

</body>
</html>